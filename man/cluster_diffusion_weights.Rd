% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/time_contrast_utils.R
\name{cluster_diffusion_weights}
\alias{cluster_diffusion_weights}
\title{Heat-kernel diffusion weights from a cluster distance matrix}
\usage{
cluster_diffusion_weights(distmat, k = 20L, sigma = NULL, beta = 1)
}
\arguments{
\item{distmat}{K x K distances between clusters (nonnegative, symmetric).}

\item{k}{Number of neighbors to keep in the affinity (default 20).}

\item{sigma}{Gaussian kernel bandwidth (default: median of nonzero distances).}

\item{beta}{Diffusion time/scale (default 1).}
}
\value{
K x K diffusion weights matrix (row-stochastic).
}
\description{
Builds a dense K x K diffusion weight matrix W â‰ˆ exp(-beta * L), where
L is the graph Laplacian built from a Gaussian KNN affinity on the provided distmat.
For large K, consider constructing W elsewhere and passing it via scheme$W to avoid O(K^3).
}
